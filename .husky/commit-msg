#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Validate commit message format with commitlint
echo "ğŸ” Validating commit message format..."
npx --no -- commitlint --edit ${1}

if [ $? -eq 0 ]; then
  echo "âœ… Commit message format is valid"
else
  echo "âŒ Commit message format validation failed"
  echo ""
  echo "ğŸ“‹ Expected format: type(scope): subject"
  echo ""
  echo "Valid types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert, config, deploy, security"
  echo "Valid scopes: servers, docker, security, docs, ci, deploy, inventory, proxmox, nas, dockermaster, containers, workflows, monitoring, backup, network, storage"
  echo ""
  echo "Example: feat(docker): add nginx container configuration"
  echo "Example: fix(security): update gitleaks configuration"
  echo "Example: docs(inventory): update server documentation"
  echo ""
  echo "ğŸ’¡ Use 'git config commit.template .gitmessage' to use the commit template"
  echo "ğŸ’¡ Use 'npm run commit' for interactive commit message creation"
  exit 1
fi
